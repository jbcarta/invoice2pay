{{# each recdata }}



<p> {{ this }} </p>


    <div class="row">
   		<h3>Datos de Usuarios</h3>

<!--   		<form action="/profile/{{ this._id }}" method="post" id="checkout-form" class="form-horizontal">
-->

            <!--******************************************

    							Email   

                ******************************************
            -->
    			<div class="form-group">
    				<label for="email" class="col-sm-2 control-label">Email 1:</label>
    				<div class="col-sm-4">
    					<input type="text" class="form-control" name="email"
    								value= "{{this.email}}" readonly required>
    				</div>
    			</div>


            <!--******************************************

   							Name   

                ******************************************
            -->
   				<div class="form-group">
   					<label for="name" class="col-sm-2 control-label">Nombre :</label>
   					<div class="col-sm-4">
   						<input  type="text" class="form-control" name="name"
   								value= "{{this.name}}">
    								
   					</div>
   				</div>
    				

				<hr></hr>
				<div id="exTab3" class="container">	
					<ul  class="nav nav-pills">
						<li class="active">
				        	<a  href="#1b" data-toggle="tab">Basicas</a>
						</li>
						<li>
							<a href="#2b" data-toggle="tab">Proveedores</a>
						</li>
						<li>
							<a href="#3b" data-toggle="tab">Centro de Costos</a>
						</li>
				  		<li>
				  			<a href="#4a" data-toggle="tab">Cuentas Contable</a>
						</li>
					</ul>

					<div class="tab-content clearfix" >
						<div class="tab-pane active"  id="1b">
                    	<!--
                    	******************************************

	    							Approver Type

                        ******************************************
                    	-->
	    				<div class="form-group">
	    					<label for="aplevel" class="col-sm-2 control-label">Tipo de Aprobador :</label>
	    					<div class="col-sm-4">
	    								
                    			<select class="selectpicker form-control" name="aplevel"
                             			id="aplevel" required>
                    			</select>

	    					</div>
	    				</div>


	                    <input  type="text" class="form-control hidden" name="save_form"
                                id="save_form" value= "NO" required>

		    			<button type="submit" class="btn btn-success" onClick="save()">Grabar</button>
		       		    <button href="#" class="btn btn-cancel pull-left" role="button">Salir sin Grabar</a>


			                    <table id="ts" name="ts" class="table table-striped table-bordered" 
			                           cellspacing="0" width="50%">
								        <thead>
								            <tr>
								                <th>Codigo</th>
								                <th>Nombre</th>
								                <th>Estatus</th>
								                <th>Mod</th>
								                <th>Bor</th>

								            </tr>
								        </thead>

										<tbody>
											{{# each this.supplier }}
									            <tr>

									                <td>{{ codsupplier }}</td>
									                <td>{{ namesupplier }}</td>
									                <td>O</td>
           											<td><i class="fa fa-pencil-square-o" class="editRow" name="editRow" id="editRow" data-toggle="modal" data-target=".mymodaltest"></i></td>
													<!--           											
														<td><a class="editRow" name="editRow" id="editRow" data-toggle="modal" data-target=".mymodaltest"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a></td>
													-->

            										<td><i class="fa fa-times" aria-hidden="true"></i></td>
									            </tr>								        
											{{/each}}								            
										</tbody>

<!--				                        <a name="addRowSupplier" id="addRowSupplier"><i class="fa fa-file-o"></i> Nuevo</a>
-->
				                        <button name="addRowSupplier" id="addRowSupplier" data-toggle="modal" data-target=".mymodaltest"><i class="fa fa-file-o"></i> Nuevo</button>
<!--
				                        <button name="saveRowSupplier" id="saveRowSupplier"  style="visibility: hidden"><i class="fa fa-floppy-o" aria-hidden="true"></i> Grabar</button>
-->				                        

			                    </table>      


							</div>
									<div class="tab-pane" id="2b">



									</div>
					        <div class="tab-pane" id="3b">
					          <h3>We applied clearfix to the tab-content to rid of the gap between the tab and the content</h3>
									</div>
					          <div class="tab-pane" id="4b">
					          <h3>We use css to change the background color of the content to be equal to the tab</h3>
									</div>
								</div>
					  </div>


<!--

    		</form>
-->    		
    <!--	</div>	 -->
    </div>

{{/each}}



<!--  *******************************  TABLAS DE DINAMICAS
-->

<!--   

       Tabla Dinamica Proveedores

-->       
    <div
    	class="modal fade bs-example-modal-sm-provee" tabindex="-1" 
        id="modal-provee"
        role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Proveedores &times;</button>
                        {{火}} {{huo}}
                </div>
                <div class="modal-body">
                    <table id="tsupply" name="tsupply" class="table table-striped table-bordered" 
                           cellspacing="0" width="50%">
                    </table>      
                </div>
            </div>
        </div>
    </div>


	<!-- 
	*************************************************   

       				Nuevo Registro Modal

  	*************************************************
	-->  

	<div class="modal fade mymodaltest" tabindex="-1" role="dialog" aria-labelledby="gridSystemModalLabel" id="mymodaltest">
  		<div class="modal-dialog" role="document">
    		<div class="modal-content">
      			<div class="modal-header">
        			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        			<h4 class="modal-title" id="gridSystemModalLabel">Asignar Proveedores</h4>
      			</div>
      			<div class="modal-body">
        			<div class="row">
          				<div class="col-md-4">
							<div class="form-group">
								<label for="codsupplier" class="col-sm-2 control-label">Codigo Proveedor :</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" name="m_codsupplier"
											id="m_codsupplier"
											required>
									</div>
								</div>
								<div class="form-group">
								<label for="codsupplier" class="col-sm-2 control-label">Nombre    :</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" name="m_namesupplier"
											id="m_namesupplier"
											readonly required>
									</div>
								</div>

          					</div>
   						</div>
      				</div>
      				<div class="modal-footer">
        				<button type="button" class="btn btn-default" 	data-dismiss="modal">Close</button>
        				<button type="button" name="saveRowSupplier" id="saveRowSupplier" class="btn btn-primary" data-dismiss="			modal">Save changes</button>
      				</div>
      			</div>	
    		</div><!-- /.modal-content -->
  		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->



<script type="text/javascript">
    $(document).ready(function () 
    {   

//    	 var oTable = $('#ts').dataTable();



        // ------------------------------------
        //         Actitate table Supply
        // -----------------------------------
        var oTable =  $('#ts').DataTable(
        {
            "pagingType": "numbers",
            "searching": false,
            "bLengthChange": false,
             dom: 'Bfrtip',
             select: true,
	        "columnDefs": [
	            {
	               "width": 20, 
	               	"targets": 0,
	                "searchable": true
	            },
	            {
	                "targets": 1,
 					"width": "50%",	                
	                "searchable": true
	            }


//	            {
//	                "targets": [ 2 ],
//	                "visible": false
//	            }
	        ]
      

//        $('#tsupply tbody')
//        .on( 'click', 'tr' , function () 
//        {
//            var tsupply = $('#tsupply').DataTable();        
//            var rowData = tsupply.row( this ).data();
//            alert(rowData); 
//            $("#modal-provee").modal("hide");            
//            $("#supplier").val(rowData);
//        } );
    	});

		$('#ts tbody').on( 'click', 'td', function () 
		{
//    		alert( 'Clicked on cell in visible column: '+oTable.cell( this ).index().columnVisible );

			var ncolum = oTable.cell( this ).index().columnVisible;
//			alert(' :', oTable.row( this ).index().columnVisible;)
//			var req.session.ncolum = ncolum;
			if (ncolum => 3 && ncolum <= 4)
			{
	  			if (oTable.cell( this ).index().columnVisible === 3)
	  			{
	  				alert('Modificar:', this);
			
//					oTable.row( this, { page: 'current' } ).select();	

					var $row = $(this).closest('td');
					alert("$row:", $row);

 //{ selected: true }
//					oTable.row( this ).data();

//					alert(oTable.row( this ).id());	  				
					alert(oTable.row( this ).data());
					alert(oTable.row( this ).data()[0]);
					document.getElementById('m_codsupplier').value = oTable.row( this ).data()[0];
					document.getElementById('m_namesupplier').value = oTable.row( this ).data()[1];

	  			}
	  			else
	  				if (oTable.cell( this ).index().columnVisible === 4)
	  				{
	  					alert('Eliminar');
	  				}

	//   		alert(oTable.column( $(this).parents('td').value() ));
	//			var aData = oTable.fnGetData( aPos[0] );    		


	//			$('#m_codsupplier').

	//    		alert("aData:", aData);

	//       	  var ts = $('#ts').DataTable();

	//	      var aData = ts.fnGetData(nRow);

	//		var aData = oTable.fnGetData(nRow);
	//	    var jqTds = $('>td', nRow);
	//	    alert("jqTds:", jqTds);
	//		jqTds[0].innerHTML = '<input type="text" value="'+aData[0]+'">';	    
	//	    jqTds[0].innerHTML = '<input id="codsupplier" name="codsupplier" class="codsupplier" "type="text" value="'+nRow[0]+'">';
		//    jqTds[1].innerHTML = '<input type="text" value="'+aData[1]+'">';
		//    jqTds[2].innerHTML = '<input type="text" value="'+aData[2]+'">';
		//    jqTds[3].innerHTML = '<input type="text" value="'+aData[3]+'">';
		//    jqTds[4].innerHTML = '<input type="text" value="'+aData[4]+'">';
	//	    jqTds[3].innerHTML = '[saveRow]()';
		}
	}
);


    // ------------------------------------
    //         addRowSupplier
    // -----------------------------------

   
    $('#saveRowSupplier').on( 'click', function (e) 
    {

    	e.preventDefault();
    	alert('SaveRowSupplier', req.session.ncolum);

//		otable
//        	.row( this )
//        	.data( "Supplier5" )
//        	.draw();    	

    } );



    });

</script>


<script type="text/javascript">



//	function addSupplier() 
//	{
//  	var tsupply = $('#tsupply').DataTable();        
//  	alert("Ëntre addSupplier");
//        	tsupply.row.add( [
//            '100',
//            'suplier nuevo',
//        ] ).draw();
//	}

$('#codsupplier').blur() 
{
//	alert('codsupplier - blur');
};



$('.codsupplier').keypress(function(e) 
{
	alert('codsupplier');
    console.log(this);
    if (e.which == 13) 
    {
//        $(this).closest('tr').next().find('input.serial').focus();
          console.log("fue Enter codsupplier");

        e.preventDefault();
    }
});

    // ------------------------------------
    //         editRow
    // -----------------------------------

//	function editRow ( oTable, nRow )

//    $('#editRow').on( 'click', function (e) 


//var table = $('#ts').DataTable();
 

    // ------------------------------------
    //         addRowSupplier
    // -----------------------------------

    
    $('#addRowSupplier').on( 'click', function (e) 
    {

    	e.preventDefault();

//    var nRow = oTable.fnGetNodes( aiNew[0] );
//    editRow( oTable, nRow );
//    nEditing = nRow;


		document.getElementById('m_codsupplier').value = "";
		document.getElementById('m_namesupplier').value = "";


    	var ts = $('#ts').DataTable();
    	alert("Ëntre");

        var nRow = ts.row.add( 
        	[
	            '<span><input type="text" value="codprovee">'+'<a href="#" data-toggle="modal" data-target=".mymodaltest"><i class="fa fa-external-link" aria-hidden="true"></i></a></span>',
	            ' sin nombre proveedor asignado ',
	            'N',
	            '<td><a class="edit" href=""><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a></td>',
	            '<td><a class="delete" href=""><i class="fa fa-times" aria-hidden="true"></i></a></td>'
        	] ).draw();


//       	alert("nRow: ",nRow);

//        var nRow = ts.row(this).data();
//     	alert("nRow: ",nRow);

// 		document.getElementById('addRowSupplier').style.visibility = 'hidden';
// 		document.getElementById('saveRowSupplier').style.visibility = 'visible';



    } );



    $('#SaveaddRowSupplier').on( 'click', function (e) 
    {

    	e.preventDefault();

//    var nRow = oTable.fnGetNodes( aiNew[0] );
//    editRow( oTable, nRow );
//    nEditing = nRow;


		document.getElementById('m_codsupplier').value = "";
		document.getElementById('m_namesupplier').value = "";


    	var ts = $('#ts').DataTable();
    	alert("Ëntre");

        var nRow = ts.row.add( 
        	[
	            '<span><input type="text" value="codprovee">'+'<a href="#" data-toggle="modal" data-target=".mymodaltest"><i class="fa fa-external-link" aria-hidden="true"></i></a></span>',
	            ' sin nombre proveedor asignado ',
	            'N',
	            '<td><a class="edit" href=""><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a></td>',
	            '<td><a class="delete" href=""><i class="fa fa-times" aria-hidden="true"></i></a></td>'
        	] ).draw();


//       	alert("nRow: ",nRow);

//        var nRow = ts.row(this).data();
//     	alert("nRow: ",nRow);

// 		document.getElementById('addRowSupplier').style.visibility = 'hidden';
// 		document.getElementById('saveRowSupplier').style.visibility = 'visible';



    } );




    // ------------------------------------
    //         saveRow
    // -----------------------------------

	function saveRow ( oTable, nRow )
    {

    	e.preventDefault();

		alert('Save');

    } ;




    $("#aprovallevel").focus()
    {


        // ------------------------------------
        //         GetAllCecos
        // -----------------------------------
        $.getJSON("/api/restGetAprovallevels", function(data)
        {        


            var opselect = $("#aplevel1").val();
            var $select = $("#aplevel");
                       
//            console.log(data);
//            var table = $('#tcecos').DataTable();        

            $.each(data, function(index, value) 
            {
//                console.log(value);
//                table.row.add([value.ceco,  value.description]).draw();

                $select.append("<option>" + value.aplevel + "</option>");
//                alert(value.codsupplier);
            });

//            alert(" json-datasupply:", datasupply);


        });

    };

</script>



